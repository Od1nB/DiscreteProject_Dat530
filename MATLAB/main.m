clear all; clc;

global global_info;
%Load data from file
%[busNr, departures, routeTime, deviation, changeDriver,...
%    changeDriverStop, changeDriverTime] = loadData('busRoutes.xlsx');

%Petri Net structure
pns = pnstruct({'connector_pdf',...
    'generator_pdf',...
    'preparation_pdf',...
    'routes_pdf',...
    'driving_pdf',...
    'cleanup_pdf',...
    });

% firing times
dyn.ft = {'tBusDriverGenerator', 1,...
    'tCONNECT1', 1,...
    'tCONNECT2', 1,...
    'tCONNECT3', 1,...
    'tCONNECT4', 1,...
    'tCONNECT5', 1,...
    'tChangeDriver', 1,...
    'tCheckOut', 1,...
    'tDriveToBusStopG', 1,...
    'tDriveToBusStopR', 1,...
    'tGenerator', 1,...
    'tIn', 1,...
    'tLobby', 1,...
    'tPick_up_bus_from_parking', 1,...
    'tPick_up_car', 1,...
    'tRoute2', 1,...
    'tRoute2_complete', 1,...
    'tRoute4', 1,...
    'tRoute4_complete', 1,...
    'tRoute6', 1,...
    'tRoute6_complete', 1,...
    'tRoutex60_postChange', 1,...
    'tRoutex60_postChange_complete', 1,...
    'tRoutex60_preChange', 1,...
    'tRoutex60_prechange_complete', 1,...
    'tTakeBusToParking', 1,...
    'tTakeCarToParking', 1,...
    'tWait', 1,...
    };

% initial state
dyn.m0 ={'pAdministration', 4};

pni = initialdynamics(pns,dyn);


%Run Simulation
sim = gpensim(pni);

prnss(sim); % print the simulation results 
plotp(sim, {'pCheckedOut'}); % plot the results